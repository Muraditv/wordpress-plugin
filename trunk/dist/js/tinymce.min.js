jQuery(document).ready(function(e){tinymce.create("tinymce.plugins.S3bubbleOembed",{init:function(t,o){t.addButton("s3bubble_oembed_global_shortcode",{title:"AWS S3Bubble",cmd:"s3bubble_oembed_global_shortcode",image:"https://s3.amazonaws.com/s3bubble-cdn/theme-images/s3bubblelogo.png"}),t.addCommand("s3bubble_oembed_global_shortcode",function(){var t=window.location.host.indexOf("www.")&&window.location.host||window.location.host.replace("www.","");e.post("https://s3bubbleapi.com/plugin/codes",{website:t},function(t){if(t.error)swal({title:"Error! "+t.message,text:"Loading...",type:"error",showCancelButton:!1,showConfirmButton:!0,confirmButtonClass:"button button-danger",confirmButtonText:"Ok",closeOnConfirm:!0},function(t){e(".s3bubble-select-group").html()});else{swal({title:"AWS GENERATED MEDIA",text:"Success your media will be listed in the dropdown below if you media is not shown please visit your media at least once in the S3Bubble Dashboard.",type:"success",showCancelButton:!0,showConfirmButton:!0,confirmButtonClass:"button button-primary",confirmButtonText:"Insert",cancelButtonText:"Cancel",closeOnConfirm:!0,closeOnCancel:!0},function(t){if(t){var o=e("#s3bubbleIframeUrl").find("option:selected").data("class"),l=e("#s3bubbleIframeUrl").find("option:selected").data("type"),n=e("#s3bubbleIframeUrl").find("option:selected").data("key"),a=e("#s3bubbleIframeUrl").find("option:selected").val();tinyMCE.activeEditor.execCommand("mceInsertContent",0,'<div class="'+o+'" data-code="'+a+'" data-type="'+l+'"><i class="s3bubble-info">AWS media '+n+" will be displayed here...</i></div>")}});var o=function(e){if(""===e||void 0===e||e===!1)return null;var t=decodeURIComponent(e);return t=t.replace(/\\/g,"")},l='<select class="chosen-select" tabindex="1" name="s3bubbleIframeUrl" id="s3bubbleIframeUrl"><option value="">Select Media</option>';e.each(t.streams,function(e,t){var n=t.stream,a=t.title?o(t.title):"No Title";l+="<option data-class='s3bubble-live' data-type='' data-key='stream' value='"+n+"'>Type: Live, Stream: "+n+", Title: "+a+"</option>"}),e.each(t.playlists,function(e,t){var n=t.code,a=o(t.title),s=t.type;l+="<option data-class='s3bubble-playlist' data-type='"+s+"' data-key='"+a+"' value='"+n+"'>Type: Playlist, Code: "+n+", Title: "+a+"</option>"}),e.each(t.media,function(e,t){var n=t.code,a=t.key,s=t.title?o(t.title):a,i=("audio"===t.type?"s3bubble-audio":"s3bubble","audio"===t.type?"s3bubble-audio":"s3bubble");l+="<option data-class='"+i+"' data-type='' data-key='"+a+"' value='"+n+"'>Type: Media, Code: "+n+", Title: "+s+"</option>"}),l+="</select>",e(".s3bubble-select-group").html(l);var n={".chosen-select":{},".chosen-select-deselect":{allow_single_deselect:!0},".chosen-select-no-single":{disable_search_threshold:10},".chosen-select-no-results":{no_results_text:"Oops, nothing found!"},".chosen-select-width":{width:"95%"}};for(var a in n)e(a).chosen(n[a])}},"json")})}}),tinymce.PluginManager.add("S3bubbleOembed",tinymce.plugins.S3bubbleOembed)});